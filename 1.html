<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>바닐라js로 메타버스 구현 1차</title>
  <style>
    body {
      margin: 0;
      height: 100vh;
      display: flex;
      justify-content: center;
      place-items: center;
    }

    canvas {
      background-color: skyblue;
    }
  </style>
</head>

<body>
  <canvas width="800" height="600" id="gamePanel"></canvas>


  <script>
    const canvas = document.getElementById('gamePanel');
    const context = canvas.getContext('2d');

    let windyWidth;
    let windyHeight;
    let windyX = ( canvas.width / 2 ) - 9.5;
    let windyY = ( canvas.height / 2 ) - 14;
    let windyCenterX;
    let windyCenterY;
    let windySpeed = 2.5;

    let windy = new Image();
    windy.src = 'assets/windy/walkingDownLeftFoot.png';

    windy.onload = function () {
      windyWidth = this.width * 1.3;
      windyHeight = this.height * 1.3;
      context.drawImage(this, windyX, windyY, windyWidth, windyHeight);
    }


    let keyState = {
      ArrowUp: false,
      ArrowDown: false,
      ArrowRight: false,
      ArrowLeft: false
    };

    window.addEventListener('keydown', (e) => {
      if (e.key in keyState) {
        keyState[e.key] = true;
      }

      if (keyState.ArrowUp == true) {
        windy.src = 'assets/windy/walkingUpLeftFoot.png' 
      }

      if (keyState.ArrowDown == true) {
        windy.src = 'assets/windy/walkingDownLeftFoot.png';
      }

      if (keyState.ArrowRight == true) {
        windy.src = 'assets/windy/walkingRight.png';
      }

      if (keyState.ArrowLeft == true) {
        windy.src = 'assets/windy/walkingLeft.png';
      }
    });

    window.addEventListener('keyup', (e) => {
      if (e.key in keyState) {
        keyState[e.key] = false;
      }
    });

    function drawWindy() {
      context.clearRect(0, 0, canvas.width, canvas.height);
      context.drawImage(windy, windyX, windyY, windyWidth, windyHeight);
    }

    function windyMove() {
      if (keyState.ArrowUp) {
        windyY -= windySpeed;
      }

      if (keyState.ArrowDown) {
        windyY += windySpeed;
      }

      if (keyState.ArrowLeft) {
        windyX -= windySpeed;
      }
      if (keyState.ArrowRight) {
        windyX += windySpeed;
      }

      drawWindy();
      requestAnimationFrame(windyMove);
    }

    windyMove();
  </script>
</body>

</html>